# Single Particle Tracking with Vision Transformers

This project investigates the use of Vision Transformers (ViTs) for single particle tracking in noisy microscopy data. The goal is to train models capable of predicting the diffusion coefficient (D) from synthetic fluorescence image sequences and performing accurate tracking on real experimental data, with the objective of surpassing traditional particle tracking methods in challenging conditions.

## Overview

- **ViT-based Regression**: Vision Transformers are used to regress the diffusion coefficient directly from sequences of images showing Brownian motion. The model captures both spatial and temporal information without requiring manual feature engineering.

- **Synthetic Data Generation**: Simulated datasets are generated by modeling particle movement through Brownian motion. Each simulation encodes parameters such as the diffusion coefficient, point spread function (PSF), pixel resolution, and frame rate.

- **Symmetry-aware Predictions**: The training process includes rotational augmentations (90°, 180°, 270°), and predictions are averaged across rotated versions of each input to ensure rotational invariance and improve robustness.

- **Real Data Tracking**: The trained model is applied to real fluorescence microscopy recordings to detect and track particle positions over time and infer physical properties such as diffusivity.

- **Comparison with Traditional Methods**: The performance of the ViT model is benchmarked against standard methods like centroid-based tracking and MSD-based diffusion estimation, particularly under noisy or low-contrast imaging conditions.

## Features

- PyTorch-based implementation of Vision Transformers for regression tasks
- Support for multi-frame grayscale input (e.g., sequences of 8 frames, 9x9 pixels each)
- Efficient pipeline for generating labeled synthetic datasets
- Consistent prediction framework incorporating rotational invariance
- Evaluation metrics to compare deep learning models with classical tracking approaches

## Applications

- Analysis of molecular motion in live-cell imaging experiments
- Quantitative assessment of diffusion processes in crowded or heterogeneous media
- Improved reliability in particle tracking for biological and materials science research



### Project Structure

├── Experiments  
│   ├── Denoising  
│   ├── Embeddings
│   ├── Framerate
│   ├── ImagesFeatures
│   ├── PSFNoise
│   └── mitochondria_simulation
│       └── old_version
├── ProjectReport.pdf
├── README.md
├── Real_data_example.ipynb
├── helpers
│   ├── helpersFeatures.py
│   ├── helpersGeneration.py
│   ├── helpersMSD.py
│   ├── helpersPlot.py
│   └── helpersTracking.py
├── models.py
├── outPoster
├── real-data
│   ├── 70_01_7.tif
│   └── 83_01_3.tif
├── tests
│   ├── RealDataTests.ipynb
│   ├── Simulator_tests
│   ├── models_tests
│   └── train_tests
└── validation_trajectories
    ├── 20
    ├── 30
    ├── valTrajsInOrder.npy
    └── valTrajsInOrderImFt.npy